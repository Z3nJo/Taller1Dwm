<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <!-- RESPONSIVE: viewport para que la página se adapte a móviles y tablets -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historial de Pedidos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="Style_paginas/historial.css">
</head>
<body>
  <div class="container my-5">
    <h2 class="text-center mb-4">Historial de Pedidos</h2>

    <!-- Contenedor de notificaciones -->
    <div id="notificaciones" class="position-fixed top-0 start-50 translate-middle-x mt-3 zindex-tooltip" style="width: 90%; max-width: 500px; display: none;">
    <!-- RESPONSIVE: position-fixed + translate-middle-x → centra notificación horizontal y se adapta a pantallas -->
    <!-- RESPONSIVE: width: 90%; max-width: 500px → ancho adaptable a móvil y desktop -->
      <!-- 
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        Tu pedido ha sido cancelado
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      -->
      <!-- 
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        Hubo un error al anular el pedido, reintente o llame al local
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      -->
    </div>
  
    <!-- Lista de pedidos -->
    <div id="historial-pedidos">
      <!-- Pedido entregado -->
      <div class="card mb-3 shadow-sm pedido" data-pedido-id="12345">
        <div class="card-header d-flex justify-content-between align-items-center">
          <!-- RESPONSIVE: d-flex justify-content-between align-items-center → distribuye contenido horizontal y se adapta verticalmente -->
          <span><strong>Pedido #12345</strong></span>
          <span class="badge bg-success">Entregado</span>
        </div>
        <div class="card-body">
          <p><strong>Fecha:</strong> 24/09/2025</p>
          <ul class="list-group mb-2">
            <li class="list-group-item d-flex justify-content-between">
              <!-- RESPONSIVE: d-flex justify-content-between → texto y precio se separan horizontalmente y se adaptan -->
              Causa de Camarón (x2) <span>$12.000</span>
            </li>
            <li class="list-group-item d-flex justify-content-between">
              Ensalada Mixta (x1) <span>$6.000</span>
            </li>
          </ul>
          <p class="text-end"><strong>Total:</strong> $18.000</p>
          <div class="text-end mt-2">
            <button class="btn btn-danger btn-cancelar" style="display: none;">Cancelar Pedido</button>
            <!-- RESPONSIVE: botón se ubica a la derecha y puede reacomodarse en pantalla pequeña -->
          </div>
        </div>
      </div>

      <!-- Pedido pendiente -->
      <div class="card mb-3 shadow-sm pedido" data-pedido-id="12346">
        <div class="card-header d-flex justify-content-between align-items-center">
          <span><strong>Pedido #12346</strong></span>
          <span class="badge bg-warning text-dark">Pendiente</span>
        </div>
        <div class="card-body">
          <p><strong>Fecha:</strong> 22/09/2025</p>
          <ul class="list-group mb-2">
            <li class="list-group-item d-flex justify-content-between">
              Pizza Napolitana (x1) <span>$8.000</span>
            </li>
          </ul>
          <p class="text-end"><strong>Total:</strong> $8.000</p>
          <div class="text-end mt-2">
            <button class="btn btn-danger btn-cancelar" style="display: inline-block;">Cancelar Pedido</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Botones generales -->
    <div class="text-center mt-4 d-flex justify-content-center gap-3 flex-wrap">
      <!-- RESPONSIVE: d-flex justify-content-center flex-wrap gap-3 → botones centrados, se acomodan en varias líneas en móviles -->
      <a href="catalogo.html" class="btn btn-secondary btn-lg">Volver al Catálogo</a>
      <button id="repetir-pedido" class="btn btn-success btn-lg" disabled>Repetir Pedido</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script para seleccionar pedido y cancelar -->
  <script>
    const pedidos = document.querySelectorAll('.pedido');
    const btnRepetir = document.getElementById('repetir-pedido');
    let pedidoSeleccionado = null;

    pedidos.forEach(pedido => {
      const estadoBadge = pedido.querySelector('.card-header .badge').textContent.trim();
      const btnCancelar = pedido.querySelector('.btn-cancelar');

      // Mostrar botón solo si el pedido está pendiente
      if (estadoBadge.toLowerCase() === 'pendiente') {
        btnCancelar.style.display = 'inline-block';
      }

      // Selección del pedido
      pedido.addEventListener('click', () => {
        if (pedidoSeleccionado) {
          pedidoSeleccionado.classList.remove('pedido-seleccionado');
        }
        pedido.classList.add('pedido-seleccionado');
        pedidoSeleccionado = pedido;
        btnRepetir.disabled = false;
      });

      // Cancelar pedido
      btnCancelar.addEventListener('click', (e) => {
        e.stopPropagation(); // 
        if (confirm('¿Deseas cancelar este pedido?')) {
          pedido.remove();
          alert('Pedido cancelado correctamente');
          if (pedidoSeleccionado === pedido) {
            pedidoSeleccionado = null;
            btnRepetir.disabled = true;
          }
        }
      });
    });

    // Repetir pedido
    btnRepetir.addEventListener('click', () => {
      if (pedidoSeleccionado) {
        const id = pedidoSeleccionado.dataset.pedidoId;
        window.location.href = "resumen.html";
      }
    });
  </script>

  <script>
    /*
    // Simulación de notificación de éxito
    const notificaciones = document.getElementById('notificaciones');
    const alertaExito = document.createElement('div');
    alertaExito.className = 'alert alert-success alert-dismissible fade show';
    alertaExito.role = 'alert';
    alertaExito.innerHTML = `
      Tu pedido ha sido cancelado
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    `;
    notificaciones.appendChild(alertaExito);
    notificaciones.style.display = 'block';

    // Simulación de notificación de error
    const alertaError = document.createElement('div');
    alertaError.className = 'alert alert-danger alert-dismissible fade show';
    alertaError.role = 'alert';
    alertaError.innerHTML = `
      Hubo un error al anular el pedido, reintente o llame al local
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    `;
    // Para probar, comentar/descomentar:
    // notificaciones.appendChild(alertaError);
    */
  </script>
</body>
</html>
